CREATE SEQUENCE "SEQ_INVOICES_DETAILS" MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 41 NOCACHE ORDER NOCYCLE;

CREATE SEQUENCE "SEQ_RECEIPTS" MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 9 NOCACHE ORDER NOCYCLE;

CREATE SEQUENCE "SEQ_TAXES" MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE ORDER NOCYCLE;

CREATE SEQUENCE "SEQ_TAXPAYERS" MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 3 NOCACHE ORDER NOCYCLE;

CREATE TABLE "REMI_INVOICES_DETAILS" (
    "ID"                NUMBER(*, 0),
    "RECEIPT_ID"        NUMBER(*, 0),
    "LINE"              NUMBER(*, 0),
    "CODE"              VARCHAR2(280 CHAR),
    "DESCRIPTION"       VARCHAR2(4000 CHAR),
    "QUANTITY"          NUMBER(10, 6),
    "UNIT_PRICE"        NUMBER(10, 6),
    "DISCOUNT"          NUMBER(10, 6),
    "PRICE_WITHOUT_TAX" NUMBER(10, 6),
    PRIMARY KEY ("ID")
);

CREATE TABLE "REMI_RECEIPTS" (
    "ID"                      NUMBER(*, 0),
    "TAXPAYER_ID"             NUMBER(*, 0),
    "ACCESS_KEY"              VARCHAR2(280 CHAR),
    "TYPE_RECEIPT"            VARCHAR2(280 CHAR),
    "ESTABLISHMENT"           VARCHAR2(280 CHAR),
    "EMISSION_POINT"          VARCHAR2(280 CHAR),
    "SEQUENCE"                VARCHAR2(280 CHAR),
    "DATE_EMISSION"           DATE,
    "AUTHORIZATION"           VARCHAR2(280 CHAR),
    "DATE_AUTHORIZATION"      DATE,
    "RECEPTOR_IDENTIFICATION" VARCHAR2(280 CHAR),
    "RECEPTOR_BUSINESS_NAME"  VARCHAR2(280 CHAR),
    "TOTAL"                   NUMBER(10, 6),
    PRIMARY KEY ("ID")
);

CREATE TABLE "REMI_TAXES" (
    "ID"                NUMBER(*, 0),
    "INVOICE_DETAIL_ID" NUMBER(*, 0),
    "CODE"              VARCHAR2(280 CHAR),
    "CODE_PERCENT"      VARCHAR2(280 CHAR),
    "TARIFF"            NUMBER(10, 6),
    "BASE_VALUE"        NUMBER(10, 6),
    "VALUE"             NUMBER(10, 6),
    PRIMARY KEY ("ID")
);

CREATE TABLE "REMI_TAXPAYERS" (
    "ID"             NUMBER(*, 0),
    "IDENTIFICATION" VARCHAR2(280 CHAR),
    "BUSINESS_NAME"  VARCHAR2(280 CHAR),
    "TRADE_NAME"     VARCHAR2(280 CHAR),
    "ADDRESS"        VARCHAR2(280 CHAR),
    PRIMARY KEY ("ID")
);

CREATE OR REPLACE TRIGGER "TR_SEQ_INVOIDES_DETAILS" BEFORE
    INSERT ON remi_invoices_details
    FOR EACH ROW
    WHEN ( new.id IS NULL )
BEGIN
    :new.id := seq_invoices_details.nextval;
END;
/

CREATE OR REPLACE TRIGGER "TR_SEQ_RECEIPTS" BEFORE
    INSERT ON remi_receipts
    FOR EACH ROW
    WHEN ( new.id IS NULL )
BEGIN
    :new.id := seq_receipts.nextval;
END;
/

CREATE OR REPLACE TRIGGER "TR_SEQ_TAXES" BEFORE
    INSERT ON remi_taxes
    FOR EACH ROW
    WHEN ( new.id IS NULL )
BEGIN
    :new.id := seq_taxes.nextval;
END;
/

CREATE OR REPLACE TRIGGER "TR_SEQ_TAXPAYERS" BEFORE
    INSERT ON remi_taxpayers
    FOR EACH ROW
    WHEN ( new.id IS NULL )
BEGIN
    :new.id := seq_taxpayers.nextval;
END;
/

ALTER TABLE "REMI_INVOICES_DETAILS"
    ADD FOREIGN KEY ( "RECEIPT_ID" )
        REFERENCES "REMI_RECEIPTS" ( "ID" )
            ON DELETE CASCADE
    ENABLE;

ALTER TABLE "REMI_RECEIPTS"
    ADD FOREIGN KEY ( "TAXPAYER_ID" )
        REFERENCES "REMI_TAXPAYERS" ( "ID" )
    ENABLE;

ALTER TABLE "REMI_TAXES"
    ADD FOREIGN KEY ( "INVOICE_DETAIL_ID" )
        REFERENCES "REMI_INVOICES_DETAILS" ( "ID" )
            ON DELETE CASCADE
    ENABLE;